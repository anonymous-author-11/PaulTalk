import std;
import hash_perf_utils;

n = 600_000;
table = SwissTable[i32, i32].new(i32_hasher, i32_eq);
insert_keys = Array[i32].new(n);
miss_keys = Array[i32].new(n);

for i in 0..n {
    insert_keys.unchecked_insert(i, i);
    miss_keys.unchecked_insert(i, i + n);
}

shuffle_i32(insert_keys, n, PRNG.new(333));
shuffle_i32(miss_keys, n, PRNG.new(444));

for i in 0..n {
    key = insert_keys.unchecked_index(i);
    table.insert(key, key * 3 + 1);
}

miss_count = 0;
for i in 0..n {
    key = miss_keys.unchecked_index(i);
    value = table.get(key);
    if value is Nil {
        miss_count = miss_count + 1;
    }
}

if miss_count == n {
    IO.print("ok");
} else {
    IO.print("bad");
}
